webpackJsonp([4],{180:function(t,e,a){(t.exports=a(1)(!1)).push([t.i,"\n.loading[data-v-d24a182a] {\n  width: 80px;\n  height: 40px;\n}\n.loading span[data-v-d24a182a] {\n  display: inline-block;\n  width: 8px;\n  height: 100%;\n  border-radius: 4px;\n  background: #90ee90;\n  -webkit-animation: load-data-v-d24a182a 1s ease infinite;\n}\n@-webkit-keyframes load-data-v-d24a182a {\n0%, 100% {\n    height: 40px;\n    background: #90ee90;\n}\n50% {\n    height: 70px;\n    margin: -15px 0;\n    background: #add8e6;\n}\n}\n.loading span[data-v-d24a182a]:nth-child(2) {\n  -webkit-animation-delay: 0.2s;\n}\n.loading span[data-v-d24a182a]:nth-child(3) {\n  -webkit-animation-delay: 0.4s;\n}\n.loading span[data-v-d24a182a]:nth-child(4) {\n  -webkit-animation-delay: 0.6s;\n}\n.loading span[data-v-d24a182a]:nth-child(5) {\n  -webkit-animation-delay: 0.8s;\n}\n",""])},181:function(t,e,a){"use strict";var n={name:"Loading",data:function(){return{height:100,opacity:1,display:"block"}},methods:{finished:function(){var t=void 0,e=0,a=this;t=setInterval(function(){a.height-=10,a.opacity-=.1,10===++e&&(clearInterval(t),a.display="none")},30)},start:function(){this.height=100,this.opacity=1,this.display="block"}}},i=(a(182),a(40)),s=Object(i.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loading",style:{margin:this.height+"px auto",opacity:this.opacity,display:this.display}},[e("span"),e("span"),e("span"),e("span"),e("span")])},[],!1,null,"d24a182a",null);s.options.__file="Loading.vue";e.a=s.exports},182:function(t,e,a){"use strict";var n=a(180);a.n(n).a},183:function(t,e,a){(t.exports=a(1)(!1)).push([t.i,"\n.images[data-v-02a66ec5],\n.medias[data-v-02a66ec5] {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: space-around;\n}\n.image_item[data-v-02a66ec5] {\n  width: 150px;\n  border-radius: 5px;\n  font-size: 12px;\n  margin: 0.5rem 1rem;\n  position: relative;\n}\n.media_item[data-v-02a66ec5] {\n  width: 300px;\n  border-radius: 5px;\n  font-size: 12px;\n  margin: 0.5rem 1rem;\n  position: relative;\n}\n.video_item[data-v-02a66ec5] {\n  width: 250px;\n  border-radius: 5px;\n  font-size: 12px;\n  margin: 0.5rem 1rem;\n  position: relative;\n}\n.image_item .hover[data-v-02a66ec5],\n.video_item .hover[data-v-02a66ec5] {\n  width: 150px;\n  height: 150px;\n  position: absolute;\n  top: 0;\n  background: rgba(39,35,39,0.48);\n  color: #fff;\n  display: none;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 10px;\n  font-size: 20px;\n}\n.image_item .hover i[data-v-02a66ec5],\n.video_item .hover i[data-v-02a66ec5] {\n  cursor: pointer;\n}\n.image_item:hover .hover[data-v-02a66ec5],\n.video_item:hover .hover[data-v-02a66ec5] {\n  display: flex;\n}\n.image_item p[data-v-02a66ec5] {\n  width: 150px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin: 0.2rem 0 0 0;\n  padding: 5px;\n  text-align: center;\n  color: #fff;\n  border-radius: 0.3rem;\n  background: #f1f3f4;\n}\n.media_item .ctrl[data-v-02a66ec5],\n.video_item .ctrl[data-v-02a66ec5] {\n  width: 300px;\n  margin: 0.2rem 0 0 0;\n  text-align: center;\n  color: #fff;\n  border-radius: 0.3rem;\n  background: #f1f3f4;\n  display: flex;\n  flex-direction: row;\n  padding: 0;\n  justify-content: space-between;\n}\n.video_item .ctrl[data-v-02a66ec5] {\n  width: 250px;\n}\n.media_item .ctrl>p[data-v-02a66ec5],\n.video_item .ctrl>p[data-v-02a66ec5] {\n  width: 230px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  line-height: 34px;\n  margin: 0;\n}\n.media_item p>.fa[data-v-02a66ec5],\n.video_item p>.fa[data-v-02a66ec5],\n.image_item p>.fa[data-v-02a66ec5] {\n  color: #4e4e4e;\n  display: none;\n}\n.media_item p:hover>.fa[data-v-02a66ec5],\n.video_item p:hover>.fa[data-v-02a66ec5],\n.image_item p:hover>.fa[data-v-02a66ec5] {\n  display: inline-block;\n}\n.image[data-v-02a66ec5] {\n  width: 150px;\n  height: 150px;\n  padding: 5px;\n  border-radius: 5px;\n  border: 2px solid #b1b1b1;\n  background: #fff;\n}\n.media[data-v-02a66ec5] {\n  margin-bottom: 5px;\n}\n.image img[data-v-02a66ec5] {\n  max-height: 100%;\n  max-width: 100%;\n  margin: 50%;\n  box-sizing: border-box;\n  transform: translateY(-50%);\n}\n.video[data-v-02a66ec5] {\n  width: 250px;\n  height: 250px;\n  padding: 5px;\n  border-radius: 5px;\n  border: 2px solid #b1b1b1;\n  background: #12161b;\n  overflow: hidden;\n}\n.video video[data-v-02a66ec5] {\n  max-height: 100%;\n  max-width: 100%;\n  margin: 50%;\n  box-sizing: border-box;\n  transform: translateX(-50%) translateY(-50%);\n}\n.upload_btn[data-v-02a66ec5] {\n  font-size: 12px;\n  overflow: hidden;\n  text-align: center;\n  margin: 10px auto;\n}\n.upload_btn input[type=file][data-v-02a66ec5] {\n  position: absolute;\n  display: none;\n}\n.flex_space_between[data-v-02a66ec5] {\n  justify-content: space-between;\n}\n.dropdown-item[data-v-02a66ec5] {\n  font-size: 14px;\n}\n.blanket[data-v-02a66ec5] {\n  font-size: 14px;\n  line-height: 250px;\n  text-align: center;\n  color: #ccc;\n}\n",""])},184:function(t,e,a){"use strict";var n={name:"source_tab",components:{loading:a(181).a},data:function(){var t={temp_type:"",loading:!0,list:[],totalNum:1,currentPage:1,groupIndex:null,group_list:this.groupList};switch(console.log(this.tab_type),this.tab_type){case 0:t.perPage=8,t.accept="image/gif, image/jpeg, image/png, image/jpg",t.acceptType="image/*";break;case 1:t.perPage=10,t.accept="audio/basic, audio/midi, audio/x-mid, audio/x-midi, audio/mpeg3, audio/mp3, audio/x-mpeg-3, audio/ogg",t.acceptType="audio/*";break;case 2:t.perPage=10,t.accept="video/ogg, video/mp4, video/webm",t.acceptType="video/*"}return t},props:{tab_type:{type:Number,required:!0,default:0},is_components:{type:Boolean,default:!1},lastIndex:{type:Number},quill:{type:Object},groupList:{required:!0,type:Array}},methods:{getList:function(t){var e=this,a=void 0;switch(e.loading=!0,this.currentPage=t,this.tab_type){case 0:a="/api/admin/source/image/";break;case 1:a="/api/admin/source/media/";break;case 2:a="/api/admin/source/video/"}this.axios.get(a+t+(null!==this.groupIndex?"?type="+this.group_list[this.groupIndex]._id:"")).then(function(t){"0000"===t.data.code?(e.totalNum=t.data.data.totalNum,e.list=t.data.data.list,e.loading=!1,e.$refs.load.finished()):console.error(t)}).catch(function(t){console.error(t)})},add_source:function(t){var e=this,a=void 0,n=void 0,i=void 0,s=void 0,o=t.target.files[0],r=o.type,d=o.size;switch(this.tab_type){case 0:a="图片",n=3145728,i="3M",s="/api/admin/article/upload/image";break;case 1:a="音频",n=6291456,i="6M",s="/api/admin/article/upload/media";break;case 2:a="视频",n=52428800,i="50M",s="/api/admin/article/upload/video"}if(-1===this.accept.indexOf(r))return e.$eventHub.$emit("alert",{type:"warning",message:"请选择我们支持的"+a+"格式!"});if(d>n)return e.$eventHub.$emit("alert",{type:"warning",message:"请选择"+i+"以内的"+a+"!"});var c=new FormData;c.append("file",o,o.name),this.axios.post(s,c,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.getList(e.currentPage)}).catch(function(t){return e.$eventHub.$emit("alert",{type:"warning",message:"上传"+a+"出错!"})})},triggerUpload:function(){document.getElementById("upload").click()},handleOk:function(t){t.preventDefault(),this.temp_type?this.handleSubmit():alert("Please enter your name")},handleSubmit:function(){var t=this,e=this;this.axios.post("/api/admin/source/type/new",{name:this.temp_type}).then(function(a){e.group_list=a.data.data,t.$emit("update",e.group_list),console.log(a),e.clearName(),e.$refs.modalForGroup.hide()}).catch(function(t){return e.$eventHub.$emit("alert",{type:"warning",message:"获取分组列表出错!"})})},clearName:function(){this.temp_type=""},deleteSource:function(t){var e,a=this;e=this.list[t],this.axios.post("/api/admin/source/delete",{_id:e._id}).then(function(t){a.getList(a.currentPage)}).catch(function(t){return a.$eventHub.$emit("alert",{type:"warning",message:"删除资源出错!"})})},setSource:function(t,e){var a,n=this;a=this.list[t],this.axios.post("/api/admin/source/set",{_id:a._id,type:e}).then(function(t){n.getList(n.currentPage)}).catch(function(t){return n.$eventHub.$emit("alert",{type:"warning",message:"删除资源出错!"})})},selectGroup:function(t){this.groupIndex=t,this.getList(1)},resetGroup:function(){this.groupIndex=null,this.getList(1)},deleteGroup:function(t){var e=this,a=this;this.axios.post("/api/admin/source/type/delete",{_id:t}).then(function(t){if("0000"!==t.data.code)return a.$eventHub.$emit("alert",{type:"warning",message:t.data.msgCN});a.group_list=t.data.data,e.$emit("update",a.group_list),a.groupIndex=null,a.getList(a.currentPage)}).catch(function(t){return a.$eventHub.$emit("alert",{type:"warning",message:"删除分组出错!"})})},insert:function(t){var e=void 0;if(this.is_components&&this.quill){switch(this.tab_type){case 0:e="image";break;case 1:e="audio";break;case 2:e="video"}this.quill.insertEmbed(this.lastIndex,e,this.list[t].url),this.quill.update(),this.quill.setSelection(this.lastIndex+1),this.$emit("hide")}}},beforeMount:function(){this.getList(1)}},i=(a(185),a(40)),s=Object(i.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("b-row",{staticClass:"flex_space_between"},[a("div",[a("b-dropdown",{staticClass:"m-md-2",attrs:{size:"sm",id:"ddown1",text:null==t.groupIndex?"选择分组":t.group_list[t.groupIndex].name}},[t._l(t.group_list,function(e,n){return a("b-dropdown-item",{key:n,on:{click:function(e){t.selectGroup(n)}}},[t._v(t._s(e.name))])}),a("b-dropdown-divider"),a("b-dropdown-item",{directives:[{name:"b-modal",rawName:"v-b-modal.modalForGroup",modifiers:{modalForGroup:!0}}]},[t._v("新建分组")])],2),null!==t.groupIndex?a("span",[a("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.resetGroup()}}},[a("i",{staticClass:"fa fa-times"})]),a("b-button",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.deleteGroup(t.group_list[t.groupIndex]._id)}}},[a("i",{staticClass:"fa fa-trash-o"})])],1):t._e()],1),a("div",[a("b-button",{staticClass:"upload_btn",attrs:{size:"sm",variant:"success"},on:{click:function(e){t.triggerUpload()}}},[a("i",{staticClass:"fa fa-plus-square "}),t._v(" 上传\n                    "),a("input",{staticClass:"upload",attrs:{id:"upload",type:"file",accept:t.acceptType},on:{change:t.add_source}})])],1)]),a("loading",{ref:"load"}),t.list.length>0?a("div",{staticClass:"tab_parent"},[0===t.tab_type?a("div",{staticClass:"images"},t._l(t.list,function(e,n){return a("div",{staticClass:"image_item"},[a("div",{staticClass:"image"},[a("b-img",{attrs:{center:"",src:e.url,alt:"Thumbnail"}})],1),a("div",{staticClass:"hover"},[a("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){t.deleteSource(n)}}},[a("i",{staticClass:"fa fa-trash-o"})]),t.group_list.length>0?a("b-dropdown",{attrs:{variant:"secondary",size:"sm","no-caret":""}},[a("template",{slot:"button-content"},[a("i",{staticClass:"fa fa-reorder"})]),a("b-dropdown-header",[t._v("移动到分组")]),t._l(t.group_list,function(i,s){return i._id!==e.group?a("b-dropdown-item",{key:s,on:{click:function(e){t.setSource(n,i._id)}}},[t._v(t._s(i.name))]):t._e()})],2):t._e()],1),t.is_components?a("p",[a("i",{staticClass:"fa fa-plus mr-2"}),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.insert(n)}}},[t._v(t._s(e.originalname))])]):t._e(),t.is_components?t._e():a("p",[a("a",{attrs:{href:"javascript:void(0);"}},[t._v(t._s(e.originalname))])])])})):t._e(),1===t.tab_type?a("div",{staticClass:"medias"},t._l(t.list,function(e,n){return a("div",{key:n,staticClass:"media_item"},[a("div",{staticClass:"media"},[a("audio",{attrs:{src:e.url,controls:"controls",loop:"loop"}})]),a("div",{staticClass:"ctrl"},[a("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){t.deleteSource(n)}}},[a("i",{staticClass:"fa fa-trash-o"})]),t.is_components?a("p",[a("i",{staticClass:"fa fa-plus mr-2"}),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.insert(n)}}},[t._v(t._s(e.originalname))])]):t._e(),t.is_components?t._e():a("p",[a("a",{attrs:{href:"javascript:void(0);"}},[t._v(t._s(e.originalname))])]),t.group_list.length>0?a("b-dropdown",{attrs:{variant:"secondary",size:"sm","no-caret":""}},[a("template",{slot:"button-content"},[a("i",{staticClass:"fa fa-reorder"})]),a("b-dropdown-header",[t._v("移动到分组")]),t._l(t.group_list,function(i,s){return i._id!==e.group?a("b-dropdown-item",{key:s,on:{click:function(e){t.setSource(n,i._id)}}},[t._v(t._s(i.name))]):t._e()})],2):t._e()],1)])})):t._e(),2===t.tab_type?a("div",{staticClass:"medias"},t._l(t.list,function(e,n){return a("div",{key:n,staticClass:"video_item"},[a("div",{staticClass:"video"},[a("video",{attrs:{src:e.url,controls:"controls",loop:"loop"}})]),a("div",{staticClass:"ctrl"},[a("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){t.deleteSource(n)}}},[a("i",{staticClass:"fa fa-trash-o"})]),t.is_components?a("p",[a("i",{staticClass:"fa fa-plus mr-2"}),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.insert(n)}}},[t._v(t._s(e.originalname))])]):t._e(),t.is_components?t._e():a("p",[a("a",{attrs:{href:"javascript:void(0);"}},[t._v(t._s(e.originalname))])]),t.group_list.length>0?a("b-dropdown",{attrs:{variant:"secondary",size:"sm","no-caret":""}},[a("template",{slot:"button-content"},[a("i",{staticClass:"fa fa-reorder"})]),a("b-dropdown-header",[t._v("移动到分组")]),t._l(t.group_list,function(i,s){return i._id!==e.group?a("b-dropdown-item",{key:s,on:{click:function(e){t.setSource(n,i._id)}}},[t._v(t._s(i.name))]):t._e()})],2):t._e()],1)])})):t._e(),a("b-pagination",{attrs:{align:"center",size:"sm","total-rows":t.totalNum,"per-page":t.perPage},on:{change:t.getList},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1):t._e(),0===t.list.length?a("div",{staticClass:"blanket"},[a("i",{staticClass:"fa fa-child"}),t._v("    没有素材\n        ")]):t._e()],1),a("b-modal",{ref:"modalForGroup",attrs:{id:"modalForGroup",size:"sm",title:"添加分组"},on:{ok:t.handleOk,shown:t.clearName}},[a("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("b-form-input",{attrs:{type:"text",size:"sm",placeholder:"请输入要添加的分组"},model:{value:t.temp_type,callback:function(e){t.temp_type=e},expression:"temp_type"}})],1)])],1)},[],!1,null,"02a66ec5",null);s.options.__file="source_tab.vue";e.a=s.exports},185:function(t,e,a){"use strict";var n=a(183);a.n(n).a},207:function(t,e,a){(t.exports=a(1)(!1)).push([t.i,"\n.bread_head[data-v-39390de8] {\n  margin-bottom: 0;\n  border-radius: 0;\n}\n",""])},253:function(t,e,a){"use strict";var n=a(207);a.n(n).a},273:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(184),i=a(181),s={name:"index",components:{sourceTab:n.a,loading:i.a},data:function(){return{tabIndex:0,breadcrumb:[{text:"Source",href:"/admin/app/source/index"}],groupList:[],loading:!0}},methods:{changTab:function(t){this.tabIndex=t},update:function(t){console.log(t),this.groupList=t}},beforeMount:function(){var t=this;this.axios.get("/api/admin/source/type/list").then(function(e){t.groupList=e.data.data,t.loading=!1,t.$refs.loadGroup.finished()}).catch(function(e){return t.$eventHub.$emit("alert",{type:"warning",message:"获取分组列表出错!"})})}},o=(a(253),a(40)),r=Object(o.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"main_container"},[a("b-breadcrumb",{staticClass:"bread_head",attrs:{items:t.breadcrumb}}),a("loading",{ref:"loadGroup"}),t.loading?t._e():a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{attrs:{small:"",card:""},on:{input:t.changTab}},[a("b-tab",{staticClass:"bg-dark",attrs:{title:"图片",active:""}},[0===t.tabIndex?a("source-tab",{attrs:{tab_type:0,groupList:t.groupList},on:{update:t.update}}):t._e()],1),a("b-tab",{staticClass:"bg-dark",attrs:{title:"音频"}},[1===t.tabIndex?a("source-tab",{attrs:{tab_type:1,groupList:t.groupList},on:{update:t.update}}):t._e()],1),a("b-tab",{staticClass:"bg-dark",attrs:{title:"视频"}},[2===t.tabIndex?a("source-tab",{attrs:{tab_type:2,groupList:t.groupList},on:{update:t.update}}):t._e()],1)],1)],1)],1)])},[],!1,null,"39390de8",null);r.options.__file="index.vue";e.default=r.exports}});